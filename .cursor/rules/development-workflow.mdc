---
description: "Development workflow for todo.ai (Python/MCP)"
alwaysApply: true
---
# Development Workflow

**Primary Language:** Python 3.14+
**Primary Interface:** MCP Server

## Repository Context

-   **Root:** `todo_ai/` (Python package source)
-   **CLI Entry:** `todo_ai/cli/main.py`
-   **MCP Entry:** `todo_ai/mcp/server.py`
-   **Core Logic:** `todo_ai/core/` (Shared logic for CLI and MCP)

## Development Rules

1.  **Python First:** All new features must be implemented in the Python package (`todo_ai/`).
2.  **File Operations:** ALWAYS use `todo_ai.core.file_ops.FileOps` for reading/writing `TODO.md`.
    -   This class handles checksums, shadow copies, and atomic updates.
    -   **NEVER** use `open()` or `write()` on `TODO.md` directly.
3.  **Testing:**
    -   Run unit tests: `uv run pytest`
    -   Test MCP tools via the MCP Inspector or Cursor.
4.  **Installation/Migration:**
    -   Installation logic resides in `todo_ai/cli/system_ops.py` (or dedicated modules).
    -   Migrations are handled by `todo_ai.core.migrations`.

## File Integrity & Tamper Detection

todo.ai uses a simple tamper detection system to protect `TODO.md` integrity.

-   **State Directory:** `.todo.ai/state/` contains critical integrity files (checksums, shadow copies).
-   **RESTRICTION:** This directory is **OFF LIMITS** to agents. Never read, write, or modify files in this directory directly.
-   **Tamper Mode:** Configured in `config.yaml` (`security.tamper_proof`).

**Developer Warning:** Never edit `TODO.md` manually during development unless you are specifically testing the tamper detection logic.
