---
description: "Bug review and task setup workflow for todo.ai development"
alwaysApply: true
---
# Bug Review Workflow

When reviewing new bugs and setting up tasks:

1. **Check GitHub for new bug issues:**
   ```zsh
   gh issue list --label "bug" --state open --json number,title,body,url
   ```
   - Review all open bugs
   - Check for unlabeled bugs that mention "bug", "fix", or "error" in title
   - Examine issue details for context

2. **Create task in TODO.md with issue number:**
   - **Preferred (MCP):** Use `add_task` tool
     - description: "Fix issue#XX: [bug description]"
     - tags: ["#bug"]
   - **Fallback (CLI):**
     ```zsh
     todo-ai add "Fix issue#XX: [bug description]" "#bug"
     ```
   - Always include `issue#XX` in task description (e.g., "Fix issue#25: ...")
   - Use `#bug` tag
   - Include issue number so commits can reference both task and issue

3. **Add subtasks for investigation and fix:**
   - **Preferred (MCP):** Use `add_subtask` tool
     - parent_id: <task-id>
     - description: "Investigate [component/cause]" (or "Fix ...", "Add tests ...")
     - tags: ["#bug"]
   - **Fallback (CLI):**
     ```zsh
     todo-ai add-subtask <task-id> "Investigate [component/cause]" "#bug"
     todo-ai add-subtask <task-id> "Fix [specific issue]" "#bug"
     todo-ai add-subtask <task-id> "Add tests for [fix verification]" "#bug"
     ```

4. **Format commits with both task and issue numbers:**
   - Use `task#nn` format for todo.ai task numbers (prevents GitHub auto-linking)
   - Use `#nn` format for GitHub issue numbers (enables linking)
   - Example: `fix: Fix delete command section placement (task#123, #25)`
   - Never use `#nn` alone for task numbers - always use `task#nn`

   **Format Examples:**
   - ✅ `fix: Fix delete command section placement (task#123, #25)`
   - ✅ `fix: Resolve footer ordering issue (task#123, #25)`
   - ❌ `fix: Fix bug (#25)` - Missing task number
   - ❌ `fix: Fix bug (123, #25)` - Task number format wrong (should be task#123)

5. **Close bug issue after fix is released:**
   ```zsh
   gh issue close <issue-number> --comment "Fixed in release [\`v2.0.1\`](https://github.com/fxstein/todo.ai/releases/tag/v2.0.1). [Short summary of the fix]"
   ```
   - **CRITICAL: Use single command** - Close with comment, don't add separate comment first
   - Always use markdown link format: `[\`vX.Y.Z\`](link to version tag)`
   - Get release tag URL: `https://github.com/fxstein/todo.ai/releases/tag/vX.Y.Z`
   - Include short summary of what was fixed
   - Never add a comment separately and then close - always close with `--comment` flag

**Closing Examples:**
- ✅ `gh issue close 25 --comment "Fixed in release [\`v2.0.1\`](https://github.com/fxstein/todo.ai/releases/tag/v2.0.1). Deleted Tasks section now correctly placed before footer."`
- ❌ Adding comment first, then closing separately - Creates duplicate comments
- ❌ Closing without markdown link - Missing clear reference to fix
