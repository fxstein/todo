# Linear PR check: enforce branch naming for auto-linking
# Design: docs/linear_integration_design.md

name: Linear PR Check

on:
  pull_request:
    types: [opened, edited, synchronize]
    branches: [main]

jobs:
  verify-branch-name:
    name: Verify branch name
    runs-on: ubuntu-latest
    steps:
      - name: Check branch name format
        run: |
          BRANCH="${{ github.head_ref }}"
          # Pattern: user/AIT-123-description (ai-todo team). Case-insensitive: AIT or ait.
          if ! echo "$BRANCH" | grep -qiE '^.+/AIT-[0-9]+-.+$'; then
            echo "::error::Branch must follow format user/AIT-123-description to auto-link Linear tickets."
            echo "Current branch: $BRANCH"
            exit 1
          fi
          echo "Branch name OK: $BRANCH"
